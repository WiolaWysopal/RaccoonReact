<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Auth0 Test App</title>
  <script src="https://cdn.auth0.com/js/auth0-spa-js/2.6.0/auth0-spa-js.production.js"></script>
<script src="config.js"></script>
<script>
window.addEventListener('load', async () => {
    const config = {
        domain: window.env.AUTH0_DOMAIN,
        client_id: window.env.AUTH0_CLIENT_ID
    };

    // użycie przez window.auth0
    const auth0Client = await window.auth0.createAuth0Client(config);

    if (window.location.search.includes("code=")) {
        await auth0Client.handleRedirectCallback();
        window.history.replaceState({}, document.title, "/");
    }

    const isAuthenticated = await auth0Client.isAuthenticated();

    if (isAuthenticated) {
        const user = await auth0Client.getUser();
        document.getElementById("user").textContent = JSON.stringify(user, null, 2);
    }

    document.getElementById("login").onclick = () => auth0Client.loginWithRedirect();
    document.getElementById("logout").onclick = () => auth0Client.logout({ returnTo: window.location.origin });
});
</script>

</head>
<body>
  <h1>Auth0 – Test App</h1>
  <button id="login">Log in</button>
  <button id="logout">Log out</button>
  <pre id="user"></pre>

</body>
</html>
